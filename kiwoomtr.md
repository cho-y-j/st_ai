TR Code	TR Name	샘플 코드
opt10001	주식기본정보요청	/entry/tr-opt10001
opt10002	주식거래원요청	/entry/tr-opt10002
opt10003	체결정보요청	/entry/tr-opt10003
opt10004	주식호가요청	/entry/tr-opt10004
opt10005	주식일주월시분요청	/entry/tr-opt10005
opt10006	주식시분요청	/entry/tr-opt10006
opt10007	시세표성정보요청	/entry/tr-opt10007
opt10008	주식외국인요청	/entry/tr-opt10008
opt10009	주식기관요청	/entry/tr-opt10009
opt10010	업종프로그램요청	 
opt10011	신주인수권전체시세요청	 
opt10012	주문체결요청	 
opt10013	신용매매동향요청	/entry/tr-opt10013
opt10014	공매도추이요청	/entry/tr-opt10014
opt10015	일별거래상세요청	 
opt10016	신고저가요청	 
opt10017	상하한가요청	 
opt10018	고저가근접요청	 
opt10019	가격급등락요청	 
opt10020	호가잔량상위요청	 
opt10021	호가잔량급증요청	 
opt10022	잔량율급증요청	 
opt10023	거래량급증요청	 
opt10024	거래량갱신요청	 
opt10025	매물대집중요청	 
opt10026	고저PER요청	 
opt10027	전일대비등락률상위요청	 
opt10028	시가대비등락률요청	 
opt10029	예상체결등락률상위요청	 
opt10030	당일거래량상위요청	 
opt10031	전일거래량상위요청	 
opt10032	거래대금상위요청	 
opt10033	신용비율상위요청	 
opt10034	외인기간별매매상위요청	 
opt10035	외인연속순매매상위요청	 
opt10036	매매상위요청	 
opt10037	외국계창구매매상위요청	 
opt10038	종목별증권사순위요청	/entry/tr-opt10038
opt10039	증권사별매매상위요청	/entry/tr-opt10039
opt10040	당일주요거래원요청	 
opt10041	조기종료통화단위요청	 
opt10042	순매수거래원순위요청	/entry/tr-opt10042
opt10043	거래원매물대분석요청	/entry/tr-opt10043
opt10044	일별기관매매종목요청	/entry/tr-opt10044
opt10045	종목별기관매매추이요청	/entry/tr-opt10045
opt10046	체결강도추이시간별요청	/entry/tr-opt10046
opt10047	체결강도추이일별요청	/entry/tr-opt10047
opt10048	ELW일별민감도지표요청	 
opt10049	ELW투자지표요청	 
opt10050	ELW민감도지표요청	 
opt10051	업종별순투자자순매수요청	 
opt10052	거래원순간거래량요청	 
opt10053	당일상위이탈원요청	 
opt10054	변동성완화장치발동종목요청	 
opt10055	당일전일체결대량요청	 
opt10058	투자자별일별매매종목요청	 
opt10059	종목별투자자기관별요청	 
opt10060	종목별투자자기관별차트요청	 
opt10061	종목별투자자기관별합계요청	 
opt10062	동일순매매순위요청	 
opt10063	장중투자자별매매요청	 
opt10064	장중투자자별매매차트요청	 
opt10065	장중투자자별매매상위요청	 
opt10066	장중투자자별매매차트요청	 
opt10067	대차거래내역요청	 
opt10068	대차거래추이요청	 
opt10069	대차거래상위10종목요청	 
opt10070	당일주요거래원요청	 
opt10071	시간대별전일비거래비중요청	 
opt10072	일자별종목별실현손익요청	 
opt10073	일자별종목별실현손익요청	 
opt10074	일자별실현손익요청	 
opt10075	실시간미체결요청	 
opt10076	실시간체결요청	 
opt10077	당일실현손익상세요청	 
opt10078	증권사별종목매매동향요청	 
opt10079	주식틱차트조회요청	 
opt10080	주식분봉차트조회요청	 
opt10081	주식일봉차트조회요청	 
opt10082	주식주봉차트조회요청	 
opt10083	주식월봉차트조회요청	 
opt10084	당일전일체결요청	 
opt10085	계좌수익률요청	 
opt10086	일별주가요청	 
opt10087	시간외단일가요청	 
opt10094	주식년봉차트조회요청	 
opt10098	시간외단일가등락율순위요청	 
opt10131	기관외국인연속매매현황요청	 
opt10170	당일매매일지요청	 
opt20001	업종현재가요청	/entry/tr-opt20001
opt20002	업종별주가요청	/entry/tr-opt20002
opt20003	전업종지수요청	/entry/tr-opt20003
opt20004	업종틱차트조회요청	/entry/tr-opt20004
opt20005	업종분봉조회요청	/entry/tr-opt20005
opt20006	업종일봉조회요청	/entry/tr-opt20006
opt20007	업종주봉조회요청	/entry/tr-opt20007
opt20008	업종월봉조회요청	/entry/tr-opt20008
opt20009	업종년봉조회요청	/entry/tr-opt20009
opt20019	업종현재가일별요청	/entry/tr-opt20019
opt20068	대차거래추이요청(종목별)	/entry/tr-opt20068
opt30001	ELW가격급등락요청	 
opt30002	거래원별ELW순매매상위요청	 
opt30003	ELWLP보유일별추이요청	 
opt30004	ELW괴리율요청	 
opt30005	ELW조건검색요청	 
opt30006	ELW종목상세요청	 
opt30007	ELW종목상세요청	 
opt30008	ELW민감도지표요청	 
opt30009	ELW등락율순위요청	 
opt30010	ELW잔량순위요청	 
opt30011	ELW근접율요청	 
opt40001	ETF수익율요청	 
opt40002	ETF종목정보요청	 
opt40003	ETF일별추이요청	 
opt40004	ETF전체시세요청	 
opt40005	ETF일별추이요청	 
opt40006	ETF시간대별추이요청	 
opt40007	ETF시간대별체결요청	 
opt40008	ETF시간대별체결요청	 
opt40009	ETF시간대별체결요청	 
opt40010	ETF시간대별추이요청	 
opt50001	선옵현재가정보요청	 
opt50002	선옵일자별체결요청	 
opt50003	선옵시고저가요청	 
opt50004	옵션행사가요청	 
opt50005	선옵시간별거래량요청	 
opt50006	선옵체결추이요청	 
opt50007	선물시세추이요청	 
opt50008	프로그램매매추이차트요청	 
opt50009	선옵시간별잔량요청	 
opt50010	선옵호가잔량추이요청	 
opt50011	선옵호가잔량추이요청	 
opt50012	선옵타임스프레드차트요청	 
opt50013	선물가격대별비중차트요청	 
opt50014	선물가격대별비중차트요청	 
opt50015	선옵미결제약정차트요청	 
opt50016	베이시스추이차트요청	 
opt50017	베이시스추이차트요청	 
opt50018	풋콜옵션비율차트요청	 
opt50019	선물옵션현재가정보요청	 
opt50020	복수종목결제월별시세요청	 
opt50021	콜종목결제월별시세요청	 
opt50022	풋종목결제월별시세요청	 
opt50023	민감도지표추이요청	 
opt50024	일별변동성분석그래프요청	 
opt50025	시간별변동성분석그래프요청	 
opt50026	선옵주문체결요청	 
opt50027	선옵잔고요청	 
opt50028	선물옵션틱차트요청	 
opt50029	선물옵션분차트요청	 
opt50030	선물옵션일차트요청	 
opt50031	선옵잔고손익요청	 
opt50032	선옵당일실현손익요청	 
opt50033	선옵잔존일조회요청	 
opt50034	선옵전일가격요청	 
opt50035	지수변동성차트요청	 
opt50036	역사적변동성차트요청	 
opt50037	코스피200지수요청	 
opt50038	투자자별만기손익차트요청	 
opt50039	투자자별포지션종합요청	 
opt50040	선옵시고저가요청	 
opt50041	주식콜옵션거래량상위종목요청	 
opt50042	주식풋옵션거래량상위종목요청	 
opt50043	주식선물거래량상위종목요청	 
opt50044	주식선물시세표요청	 
opt50062	선물미결제약정분차트요청	 
opt50063	옵션미결제약정일차트요청	 
opt50064	옵션미결제약정분차트요청	 
opt50065	풋옵션행사가요청	 
opt50066	옵션틱차트요청	 
opt50067	옵션분차트요청	 
opt50068	옵션일차트요청	 
opt50071	선물주차트요청	 
opt50072	선물월차트요청	 
opt50073	선물년차트요청	 
opt90001	테마그룹별요청	/entry/tr-opt90001
opt90002	테마구성종목요청	/entry/tr-opt90002
opt90003	프로그램순매수상위50요청	/entry/tr-opt90003
opt90004	종목별프로그램매매현황요청	/entry/tr-opt90004
opt90005	프로그램매매추이요청	/entry/tr-opt90005
opt90006	프로그램매매차익잔고추이요청	/entry/tr-opt90006
opt90007	프로그램매매누적추이요청	/entry/tr-opt90007
opt90008	종목일별프로그램매매추이요청	
opt90009	외국인기관매매상위요청	/entry/tr-opt90009
opt90011	차익잔고현황요청	 
opt90012	대차거래내역요청	
opt90013	종목일별프로그램매매추이요청	
opt99999	대차거래상위10종목요청	 
optfofid	선물전체시세요청	 
optkwfid	관심종목정보요청	 
optkwinv	관심종목투자자정보요청	 
optkwpro	관심종목프로그램정보요청	 
opw00001	예수금상세현황요청	 
opw00002	일별추정예탁자산현황요청	 
opw00003	추정자산조회요청	 
opw00004	계좌평가현황요청	 
opw00005	체결잔고요청	 
opw00006	관리자별주문체결내역요청	 
opw00007	계좌별주문체결내역상세요청	 
opw00008	계좌별익일결제예정내역요청	 
opw00009	계좌별주문체결현황요청	 
opw00010	주문인출가능금액요청	 
opw00011	증거금율별주문가능수량조회요청	 
opw00012	신용보증금율별주문가능수량조회요청	 
opw00013	증거금세부내역조회요청	 
opw00014	비밀번호일치여부요청	 
opw00015	위탁종합거래내역요청	 
opw00016	일별계좌수익률상세현황요청	 
opw00017	계좌별당일현황요청	 
opw00018	계좌평가잔고내역요청	 
opw10001	ELW종목별민감도지표요청	 
opw10002	ELW투자지표요청	 
opw10003	ELW민감도지표요청	 
opw10004	업종별순매수요청	 
opw20001	선물옵션청산주문위탁증거금가계산요청	 
opw20002	선옵당일매매변동현황요청	 
opw20003	선옵기간손익조회요청	 
opw20004	선옵주문체결내역상세요청	 
opw20005	선옵주문체결내역상세평균가요청	 
opw20006	선옵잔고상세현황요청	 
opw20007	선옵잔고현황정산가기준요청	 
opw20008	계좌별결제예상내역조회요청	 
opw20009	선옵계좌별주문가능수량요청	 
opw20010	선옵예탁금및증거금조회요청	 
opw20011	선옵계좌예비증거금상세요청	 
opw20012	선옵증거금상세내역요청	 
opw20013	계좌미결제청산가능수량조회요청	 
opw20014	선옵실시간증거금산출요청	 
opw20015	옵션매도주문증거금현황요청	
opw20016	신용융자가능종목요청	
opw20017	신용융자가능문의	




tr-opt10001(주식기본정보요청)
 

REQUEST Code
string trStockCd = tbTrStockCd.Text;
axKHOpenAPI.SetInputValue("종목코드", trStockCd);
axKHOpenAPI.CommRqData("RQName", trCd, 0, GetScrNum());
 

RESPONSE Code
//TR 조회 요구에 대한 데이터 수신 이벤트
private void axKHOpenAPI_OnReceiveTrData(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    switch (e.sTrCode.ToLower()) {
        case "opt10001": //주식기본정보요청 
            funcOpt10001(sender, e);
            break;
    }
}

// 주식기본정보요청 
private void funcOpt10001(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    try {
        string[] columns = new string[] { "종목코드", "종목명", "결산월", "액면가", "자본금", "상장주식", "신용비율", "연중최고", "시가총액", "시가총액비중", "외인소진률", "대용가", "PER", "EPS", "ROE", "PBR", "EV", "BPS", "매출액", "영업이익", "당기순이익", "250최고", "250최저", "시가", "고가", "저가", "상한가", "하한가", "기준가", "예상체결가", "예상체결수량", "250최고가일", "250최고가대비율", "250최저가일", "250최저가대비율", "현재가", "대비기호", "전일대비", "등락율", "거래량", "거래대비", "액면가단위", "유통주식", "유통비율" };

        List<string[]> list = new List<string[]>();

        Console.WriteLine("<!-- Start funcOpt10001 (주식기본정보요청) -->");
        int ni = 0;
        for (int i = 0; i < columns.Length; i++) {
            string[] row = new string[2];
            row[0] = columns[i];
            row[1] = axKHOpenAPI.GetCommData(e.sTrCode, e.sRQName, ni, columns[i]).Trim();
            list.Add(row);
        }
        PrintHtmlTable(list);
        Console.WriteLine("<!-- End funcOpt10001 (주식기본정보요청) -->");
    }
    catch (Exception e1) {
        Console.WriteLine(e1.StackTrace);
    }
}

public void PrintHtmlTable(List<string[]> list) {
    string table = "<table>\r\n";
    for (int i = 0; i < list.Count; i++) {
        table +="<tr>";
        for (int j = 0; j < list[i].Length; j++) {
            table += string.Format("<td>{0}</td>", list[i][j]);
        }
        table +="</tr>\r\n";
    }
    table +="</table>";
    Console.WriteLine(table);
    tbLog.Text = table;
}


tr-opt10004(주식호가요청)
REQUEST Code
string trStockCd = tbTrStockCd.Text;
string trCd = "opt10004";
axKHOpenAPI.SetInputValue("종목코드", trStockCd);
axKHOpenAPI.CommRqData("RQName", trCd, 0, GetScrNum());
 

RESPONSE Code
//TR 조회 요구에 대한 데이터 수신 이벤트
private void axKHOpenAPI_OnReceiveTrData(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    switch (e.sTrCode.ToLower()) {
        case "opt10004": //주식호가요청
            funcOpt10004(sender, e);
            break;
    }
}

// 주식호가요청(opt10004) 
private void funcOpt10004(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    try {
		string[] columns = new string[] { "호가잔량기준시간", "매도10차선잔량대비", "매도10차선잔량", "매도10차선호가", "매도9차선잔량대비", "매도9차선잔량", "매도9차선호가", "매도8차선잔량대비", "매도8차선잔량", "매도8차선호가", "매도7차선잔량대비", "매도7차선잔량", "매도7차선호가", "매도6차선잔량대비", "매도6차선잔량", "매도6차선호가", "매도5차선잔량대비", "매도5차선잔량", "매도5차선호가", "매도4차선잔량대비", "매도4차선잔량", "매도4차선호가", "매도3차선잔량대비", "매도3차선잔량", "매도3차선호가", "매도2차선잔량대비", "매도2차선잔량", "매도2차선호가", "매도1차선잔량대비", "매도최우선잔량", "매도최우선호가", "매수최우선호가", "매수최우선잔량", "매도1차선잔량대비", "매도2차선호가", "매도2차선잔량", "매도2차선잔량대비", "매도3차선호가", "매도3차선잔량", "매도3차선잔량대비", "매도4차선호가", "매도4차선잔량", "매도4차선잔량대비", "매도5차선호가", "매도5차선잔량", "매도5차선잔량대비", "매도6차선호가", "매도6차선잔량", "매도6차선잔량대비", "매도7차선호가", "매도7차선잔량", "매도7차선잔량대비", "매도8차선호가", "매도8차선잔량", "매도8차선잔량대비", "매도9차선호가", "매도9차선잔량", "매도9차선잔량대비", "매도10차선호가", "매도10차선잔량", "매도10차선잔량대비", "총매도잔량직전대비", "총매도잔량", "총매수잔량", "총매수잔량직전대비", "시간외매도잔량대비", "시간외매도잔량", "시간외매수잔량", "시간외매수잔량대비" };
        

        List<string[]> list = new List<string[]>();
        list.Add(columns);
        Console.WriteLine("<!-- Start funcOpt10004 (주식호가요청(opt10004)) -->");
        int nCnt = axKHOpenAPI.GetRepeatCnt(e.sTrCode, e.sRQName);
        for (int ni = 0; ni < nCnt; ni++) {
            string[] row = new string[columns.Length];
            for (int i = 0; i < columns.Length; i++) {
                row[i] = axKHOpenAPI.GetCommData(e.sTrCode, e.sRQName, ni, columns[i]).Trim();
            }
            list.Add(row);
        }
        PrintHtmlTable(list);
        Console.WriteLine("<!-- End funcOpt10004 (주식호가요청(opt10004)) -->");
    }
    catch (Exception e1) {
        Console.WriteLine(e1.StackTrace);
    }
}

public void PrintHtmlTable(List<string[]> list) {
    string table = "<table>\r\n";
    for (int i = 0; i < list.Count; i++) {
        table +="<tr>";
        for (int j = 0; j < list[i].Length; j++) {
            table += string.Format("<td>{0}</td>", list[i][j]);
        }
        table +="</tr>\r\n";
    }
    table +="</table>";
    Console.WriteLine(table);
    tbLog.Text = table;
}





tr-opt10003(체결정보요청)
REQUEST Code
string trStockCd = tbTrStockCd.Text;
string trCd = "opt10003";
axKHOpenAPI.SetInputValue("종목코드", trStockCd);
axKHOpenAPI.CommRqData("RQName", trCd, 0, GetScrNum());
 

RESPONSE Code
//TR 조회 요구에 대한 데이터 수신 이벤트
private void axKHOpenAPI_OnReceiveTrData(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    switch (e.sTrCode.ToLower()) {
        case "opt10003": //체결정보요청 
            funcOpt10003(sender, e);
            break;
    }
}

// 체결정보요청 
private void funcOpt10003(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    try {
        string[] columns = new string[] { "시간", "현재가", "전일대비", "대비율", "우선매도호가단위", "우선매수호가단위", "체결거래량", "sign", "누적거래량", "누적거래대금", "체결강도" };

        List<string[]> list = new List<string[]>();
        list.Add(columns);
        Console.WriteLine("<!-- Start funcOpt10003 (체결정보요청) -->");
        int nCnt = axKHOpenAPI.GetRepeatCnt(e.sTrCode, e.sRQName);
        for (int ni = 0; ni < nCnt; ni++) {
            string[] row = new string[columns.Length];
            for (int i = 0; i < columns.Length; i++) {
                row[i] = axKHOpenAPI.GetCommData(e.sTrCode, e.sRQName, ni, columns[i]).Trim();
            }
            list.Add(row);
        }
        PrintHtmlTable(list);
        Console.WriteLine("<!-- End funcOpt10003 (체결정보요청) -->");
    }
    catch (Exception e1) {
        Console.WriteLine(e1.StackTrace);
    }
}

public void PrintHtmlTable(List<string[]> list) {
    string table = "<table>\r\n";
    for (int i = 0; i < list.Count; i++) {
        table +="<tr>";
        for (int j = 0; j < list[i].Length; j++) {
            table += string.Format("<td>{0}</td>", list[i][j]);
        }
        table +="</tr>\r\n";
    }
    table +="</table>";
    Console.WriteLine(table);
    tbLog.Text = table;
}



tr-opt10005(주식일주월시분요청)
REQUEST Code
string trStockCd = tbTrStockCd.Text;
string trCd = "opt10005";
axKHOpenAPI.SetInputValue("종목코드", trStockCd);
axKHOpenAPI.CommRqData("RQName", trCd, 0, GetScrNum());
 

RESPONSE Code
//TR 조회 요구에 대한 데이터 수신 이벤트
private void axKHOpenAPI_OnReceiveTrData(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    switch (e.sTrCode.ToLower()) {
        case "opt10005": // 주식일주월시분요청 
            funcOpt10005(sender, e);
            break;
    }
}

// 주식일주월시분요청 
private void funcOpt10005(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    try {
		string[] columns = new string[] { "날짜", "시가", "고가", "저가", "종가", "대비", "등락률", "거래량", "거래대금", "체결강도", "외인보유", "외인비중", "외인순매수", "기관순매수", "개인순매수", "외국계", "신용잔고율", "프로그램" };
        

        List<string[]> list = new List<string[]>();
        list.Add(columns);
        Console.WriteLine("<!-- Start funcOpt10005 (주식일주월시분요청) -->");
        int nCnt = axKHOpenAPI.GetRepeatCnt(e.sTrCode, e.sRQName);
        for (int ni = 0; ni < nCnt; ni++) {
            string[] row = new string[columns.Length];
            for (int i = 0; i < columns.Length; i++) {
                row[i] = axKHOpenAPI.GetCommData(e.sTrCode, e.sRQName, ni, columns[i]).Trim();
            }
            list.Add(row);
        }
        PrintHtmlTable(list);
        Console.WriteLine("<!-- End funcOpt10005 (주식일주월시분요청) -->");
    }
    catch (Exception e1) {
        Console.WriteLine(e1.StackTrace);
    }
}

public void PrintHtmlTable(List<string[]> list) {
    string table = "<table>\r\n";
    for (int i = 0; i < list.Count; i++) {
        table +="<tr>";
        for (int j = 0; j < list[i].Length; j++) {
            table += string.Format("<td>{0}</td>", list[i][j]);
        }
        table +="</tr>\r\n";
    }
    table +="</table>";
    Console.WriteLine(table);
    tbLog.Text = table;
}




tr-opt10006(주식시분요청)
REQUEST Code
string trStockCd = tbTrStockCd.Text;
string trCd = "opt10006";
axKHOpenAPI.SetInputValue("종목코드", trStockCd);
axKHOpenAPI.CommRqData("RQName", trCd, 0, GetScrNum());
 

RESPONSE Code
//TR 조회 요구에 대한 데이터 수신 이벤트
private void axKHOpenAPI_OnReceiveTrData(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    switch (e.sTrCode.ToLower()) {
        case "opt10006": // 주식시분요청 
            funcOpt10006(sender, e);
            break;
    }
}

// 주식시분요청 
private void funcOpt10006(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    try {
		string[] columns = new string[] { "날짜", "시가", "고가", "저가", "종가", "대비", "등락률", "거래량", "거래대금", "체결강도" };
        

        List<string[]> list = new List<string[]>();
        list.Add(columns);
        Console.WriteLine("<!-- Start funcOpt10006 (주식시분요청) -->");
        int nCnt = axKHOpenAPI.GetRepeatCnt(e.sTrCode, e.sRQName);
        for (int ni = 0; ni < nCnt; ni++) {
            string[] row = new string[columns.Length];
            for (int i = 0; i < columns.Length; i++) {
                row[i] = axKHOpenAPI.GetCommData(e.sTrCode, e.sRQName, ni, columns[i]).Trim();
            }
            list.Add(row);
        }
        PrintHtmlTable(list);
        Console.WriteLine("<!-- End funcOpt10006 (주식시분요청) -->");
    }
    catch (Exception e1) {
        Console.WriteLine(e1.StackTrace);
    }
}

public void PrintHtmlTable(List<string[]> list) {
    string table = "<table>\r\n";
    for (int i = 0; i < list.Count; i++) {
        table +="<tr>";
        for (int j = 0; j < list[i].Length; j++) {
            table += string.Format("<td>{0}</td>", list[i][j]);
        }
        table +="</tr>\r\n";
    }
    table +="</table>";
    Console.WriteLine(table);
    tbLog.Text = table;
}




tr-opt10007(시세표성정보요청)
REQUEST Code
string trStockCd = tbTrStockCd.Text;
string trCd = "opt10007";
axKHOpenAPI.SetInputValue("종목코드", trStockCd);
axKHOpenAPI.CommRqData("RQName", trCd, 0, GetScrNum());
 

RESPONSE Code
//TR 조회 요구에 대한 데이터 수신 이벤트
private void axKHOpenAPI_OnReceiveTrData(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    switch (e.sTrCode.ToLower()) {
        case "opt10007": // 시세표성정보요청 
            funcOpt10007(sender, e);
            break;
    }
}

// 시세표성정보요청 
private void funcOpt10007(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    try {
		string[] columns = new string[] { "종목명", "종목코드", "날짜", "시간", "전일", "종가", "전일거래량", "상한가", "하한가", "전일거래대금", "상장주식수", "현재가", "부호", "등락률", "전일비", "시가", "고가", "저가", "체결량", "거래량", "거래대금", "예상체결가", "예상체결량", "예상매도우선호가", "예상매수우선호가", "거래시작일", "행사가격", "최고가", "최저가", "최고가일", "최저가일", "매도1호가", "매도2호가", "매도3호가", "매도4호가", "매도5호가", "매도6호가", "매도7호가", "매도8호가", "매도9호가", "매도10호가", "매수1호가", "매수2호가", "매수3호가", "매수4호가", "매수5호가", "매수6호가", "매수7호가", "매수8호가", "매수9호가", "매수10호가", "매도1호가잔량", "매도2호가잔량", "매도3호가잔량", "매도4호가잔량", "매도5호가잔량", "매도6호가잔량", "매도7호가잔량", "매도8호가잔량", "매도9호가잔량", "매도10호가잔량", "매수1호가잔량", "매수2호가잔량", "매수3호가잔량", "매수4호가잔량", "매수5호가잔량", "매수6호가잔량", "매수7호가잔량", "매수8호가잔량", "매수9호가잔량", "매수10호가잔량", "매도1호가직전대비", "매도2호가직전대비", "매도3호가직전대비", "매도4호가직전대비", "매도5호가직전대비", "매도6호가직전대비", "매도7호가직전대비", "매도8호가직전대비", "매도9호가직전대비", "매도10호가직전대비", "매수1호가직전대비", "매수2호가직전대비", "매수3호가직전대비", "매수4호가직전대비", "매수5호가직전대비", "매수6호가직전대비", "매수7호가직전대비", "매수8호가직전대비", "매수9호가직전대비", "매수10호가직전대비", "매도1호가건수", "매도2호가건수", "매도3호가건수", "매도4호가건수", "매도5호가건수", "매수1호가건수", "매수2호가건수", "매수3호가건수", "매수4호가건수", "매수5호가건수", "LP매도1호가잔량", "LP매도2호가잔량", "LP매도3호가잔량", "LP매도4호가잔량", "LP매도5호가잔량", "LP매도6호가잔량", "LP매도7호가잔량", "LP매도8호가잔량", "LP매도9호가잔량", "LP매도10호가잔량", "LP매수1호가잔량", "LP매수2호가잔량", "LP매수3호가잔량", "LP매수4호가잔량", "LP매수5호가잔량", "LP매수6호가잔량", "LP매수7호가잔량", "LP매수8호가잔량", "LP매수9호가잔량", "LP매수10호가잔량", "총매수잔량", "총매도잔량", "총매수건수", "총매도건수" };
        

        List<string[]> list = new List<string[]>();
        list.Add(columns);
        Console.WriteLine("<!-- Start funcOpt10007 (시세표성정보요청) -->");
        int nCnt = axKHOpenAPI.GetRepeatCnt(e.sTrCode, e.sRQName);
        for (int ni = 0; ni < nCnt; ni++) {
            string[] row = new string[columns.Length];
            for (int i = 0; i < columns.Length; i++) {
                row[i] = axKHOpenAPI.GetCommData(e.sTrCode, e.sRQName, ni, columns[i]).Trim();
            }
            list.Add(row);
        }
        PrintHtmlTable(list);
        Console.WriteLine("<!-- End funcOpt10007 (시세표성정보요청) -->");
    }
    catch (Exception e1) {
        Console.WriteLine(e1.StackTrace);
    }
}

public void PrintHtmlTable(List<string[]> list) {
    string table = "<table>\r\n";
    for (int i = 0; i < list.Count; i++) {
        table +="<tr>";
        for (int j = 0; j < list[i].Length; j++) {
            table += string.Format("<td>{0}</td>", list[i][j]);
        }
        table +="</tr>\r\n";
    }
    table +="</table>";
    Console.WriteLine(table);
    tbLog.Text = table;
}



tr-opt10008(주식외국인요청)
REQUEST Code
string trStockCd = tbTrStockCd.Text;
string trCd = "opt10008";
axKHOpenAPI.SetInputValue("종목코드", trStockCd);
axKHOpenAPI.CommRqData("RQName", trCd, 0, GetScrNum());
 

RESPONSE Code
//TR 조회 요구에 대한 데이터 수신 이벤트
private void axKHOpenAPI_OnReceiveTrData(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    switch (e.sTrCode.ToLower()) {
        case "opt10008": // 주식외국인요청 
            funcOpt10008(sender, e);
            break;
    }
}

// 주식외국인요청 
private void funcOpt10008(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    try {
		string[] columns = new string[] { "일자", "종가", "전일대비", "거래량", "변동수량", "보유주식수", "비중", "취득가능주식수", "외국인한도", "외국인한도증감", "한도소진률" };
        

        List<string[]> list = new List<string[]>();
        list.Add(columns);
        Console.WriteLine("<!-- Start funcOpt10008 (주식외국인요청) -->");
        int nCnt = axKHOpenAPI.GetRepeatCnt(e.sTrCode, e.sRQName);
        for (int ni = 0; ni < nCnt; ni++) {
            string[] row = new string[columns.Length];
            for (int i = 0; i < columns.Length; i++) {
                row[i] = axKHOpenAPI.GetCommData(e.sTrCode, e.sRQName, ni, columns[i]).Trim();
            }
            list.Add(row);
        }
        PrintHtmlTable(list);
        Console.WriteLine("<!-- End funcOpt10008 (주식외국인요청) -->");
    }
    catch (Exception e1) {
        Console.WriteLine(e1.StackTrace);
    }
}

public void PrintHtmlTable(List<string[]> list) {
    string table = "<table>\r\n";
    for (int i = 0; i < list.Count; i++) {
        table +="<tr>";
        for (int j = 0; j < list[i].Length; j++) {
            table += string.Format("<td>{0}</td>", list[i][j]);
        }
        table +="</tr>\r\n";
    }
    table +="</table>";
    Console.WriteLine(table);
    tbLog.Text = table;
}



tr-opt10014(공매도추이요청)
REQUEST Code
string trStockCd = "005930"; //삼성전자
string trCd = "opt10014";
string startDate = "20220926";
string endDate = "20220930";

//종목코드 = 전문 조회할 종목코드
axKHOpenAPI.SetInputValue("종목코드", trStockCd);
//시간구분 = 0:시작일, 1:기간
axKHOpenAPI.SetInputValue("시간구분", "1");
//일자 = YYYYMMDD (20160101 연도4자리, 월 2자리, 일 2자리 형식)
axKHOpenAPI.SetInputValue("시작일자", startDate);
//일자 = YYYYMMDD (20160101 연도4자리, 월 2자리, 일 2자리 형식)
axKHOpenAPI.SetInputValue("종료일자", endDate);
axKHOpenAPI.CommRqData("RQName", trCd, 0, GetScrNum());
 

RESPONSE Code
//TR 조회 요구에 대한 데이터 수신 이벤트
private void axKHOpenAPI_OnReceiveTrData(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    switch (e.sTrCode.ToLower()) {
        case "opt10014": // 공매도추이요청 
            funcOpt10014(sender, e);
            break;
    }
}

// 공매도추이요청 
private void funcOpt10014(object sender, AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent e) {
    try {
		string[] columns = new string[] { "일자", "종가", "전일대비기호", "전일대비", "등락율", "거래량", "공매도량", "매매비중", "공매도거래대금", "공매도평균가" };
        

        List<string[]> list = new List<string[]>();
        list.Add(columns);
        Console.WriteLine("<!-- Start funcOpt10014 (공매도추이요청) -->");
        int nCnt = axKHOpenAPI.GetRepeatCnt(e.sTrCode, e.sRQName);
        for (int ni = 0; ni < nCnt; ni++) {
            string[] row = new string[columns.Length];
            for (int i = 0; i < columns.Length; i++) {
                row[i] = axKHOpenAPI.GetCommData(e.sTrCode, e.sRQName, ni, columns[i]).Trim();
            }
            list.Add(row);
        }
        PrintHtmlTable(list);
        Console.WriteLine("<!-- End funcOpt10014 (공매도추이요청) -->");
    }
    catch (Exception e1) {
        Console.WriteLine(e1.StackTrace);
    }
}

public void PrintHtmlTable(List<string[]> list) {
    string table = "<table>\r\n";
    for (int i = 0; i < list.Count; i++) {
        table +="<tr>";
        for (int j = 0; j < list[i].Length; j++) {
            table += string.Format("<td>{0}</td>", list[i][j]);
        }
        table +="</tr>\r\n";
    }
    table +="</table>";
    Console.WriteLine(table);
    tbLog.Text = table;
}